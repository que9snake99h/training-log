<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>å¥åº·ãƒ­ã‚°</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: sans-serif;
      max-width: 420px;
      margin: auto;
      padding: 12px;
    }
    h2 {
      margin-bottom: 8px;
    }
    label {
      display: block;
      margin-top: 10px;
    }
    input, select {
      width: 100%;
      padding: 6px;
      margin-top: 4px;
    }
    .card {
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 12px;
      margin-top: 12px;
    }
    button {
      width: 100%;
      padding: 10px;
      margin-top: 12px;
      font-size: 16px;
    }
    .hidden {
      display: none;
    }
    .tab {
      display: flex;
      gap: 8px;
      margin-top: 12px;
    }
  </style>
</head>
<body>

<!-- ===== å…¥åŠ›ç”»é¢ ===== -->
<div id="inputView">
  <h2 id="dayType"></h2>

  <label>
    æ—¥ä»˜
    <input type="date" id="date">
  </label>

  <label>
    ä½“é‡ï¼ˆkgï¼‰
    <input type="number" id="weight" step="0.1" value="63">
  </label>

  <div id="training" class="card">
    <h3>ğŸ‹ ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</h3>
    <label><input type="checkbox" id="trainDone"> ã‚„ã£ãŸ</label>

    <label>
      ãƒ¡ãƒ‹ãƒ¥ãƒ¼
      <select id="menu">
        <option>ï¼ˆæœªé¸æŠï¼‰</option>
        <option>è…•ç«‹ã¦</option>
        <option>è…¹ç­‹</option>
        <option>ã‚¹ã‚¯ãƒ¯ãƒƒãƒˆ</option>
      </select>
    </label>

    <label>
      å›æ•°
      <input type="number" id="count">
    </label>
  </div>

  <div id="stretch" class="card">
    <h3>ğŸ§˜ ã‚¹ãƒˆãƒ¬ãƒƒãƒ</h3>
    <label><input type="checkbox" id="stretchDone"> ã‚„ã£ãŸ</label>

    <label><input type="checkbox" class="part" value="é ­"> é ­</label>
    <label><input type="checkbox" class="part" value="é¦–"> é¦–</label>
    <label><input type="checkbox" class="part" value="è‚©"> è‚©</label>
    <label><input type="checkbox" class="part" value="èƒŒä¸­"> èƒŒä¸­</label>
    <label><input type="checkbox" class="part" value="è…°"> è…°</label>
    <label><input type="checkbox" class="part" value="è¶³"> è¶³</label>
  </div>

  <button onclick="save()">ä¿å­˜</button>
</div>

<!-- ===== å±¥æ­´ç”»é¢ ===== -->
<div id="historyView" class="hidden">
  <h2>ğŸ“… å±¥æ­´</h2>
  <div id="historyList"></div>
</div>

<!-- ===== ã‚¿ãƒ– ===== -->
<div class="tab">
  <button onclick="showInput()">ğŸ“ å…¥åŠ›</button>
  <button onclick="showHistory()">ğŸ“… å±¥æ­´</button>
</div>

<script>
  const dateInput = document.getElementById("date");
  const weightInput = document.getElementById("weight");
  const trainingDiv = document.getElementById("training");
  const stretchDiv = document.getElementById("stretch");
  const dayTypeLabel = document.getElementById("dayType");

  const inputView = document.getElementById("inputView");
  const historyView = document.getElementById("historyView");
  const historyList = document.getElementById("historyList");

  // ä»Šæ—¥ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ
  const today = new Date().toISOString().slice(0, 10);
  dateInput.value = today;

  function isTrainingDay(dateStr) {
    return new Date(dateStr).getDate() % 2 === 0;
  }

  function updateUI() {
    const date = dateInput.value;
    const trainingDay = isTrainingDay(date);

    trainingDiv.style.display = trainingDay ? "block" : "none";
    stretchDiv.style.display = trainingDay ? "none" : "block";
    dayTypeLabel.textContent = trainingDay ? "ğŸ‹ ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã®æ—¥" : "ğŸ§˜ ã‚¹ãƒˆãƒ¬ãƒƒãƒã®æ—¥";

    load();
  }

  dateInput.addEventListener("change", updateUI);

  function save() {
    const date = dateInput.value;
    const trainingDay = isTrainingDay(date);

    const record = {
      date,
      weight: weightInput.value,
      type: trainingDay ? "training" : "stretch"
    };

    if (trainingDay) {
      record.done = trainDone.checked;
      record.menu = menu.value;
      record.count = count.value;
    } else {
      record.done = stretchDone.checked;
      record.parts = [...document.querySelectorAll(".part:checked")].map(p => p.value);
    }

    localStorage.setItem(date, JSON.stringify(record));
    alert("ä¿å­˜ã—ã¾ã—ãŸ");
  }

  function load() {
    const data = localStorage.getItem(dateInput.value);
    if (!data) return;

    const r = JSON.parse(data);
    weightInput.value = r.weight;

    if (r.type === "training") {
      trainDone.checked = r.done;
      menu.value = r.menu;
      count.value = r.count;
    } else {
      stretchDone.checked = r.done;
      document.querySelectorAll(".part").forEach(p => {
        p.checked = r.parts?.includes(p.value);
      });
    }
  }

  function showHistory() {
    inputView.classList.add("hidden");
    historyView.classList.remove("hidden");
    renderHistory();
  }

  function showInput() {
    historyView.classList.add("hidden");
    inputView.classList.remove("hidden");
  }

  function renderHistory() {
    historyList.innerHTML = "";

    Object.keys(localStorage)
      .sort()
      .reverse()
      .forEach(key => {
        const r = JSON.parse(localStorage.getItem(key));
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `
          <strong>${r.date}</strong><br>
          ${r.type === "training" ? "ğŸ‹ ãƒˆãƒ¬" : "ğŸ§˜ ã‚¹ãƒˆãƒ¬"} /
          ä½“é‡ ${r.weight}kg<br>
          ${r.done ? "å®Ÿæ–½" : "æœªå®Ÿæ–½"}
        `;
        div.onclick = () => {
          showInput();
          dateInput.value = r.date;
          updateUI();
        };
        historyList.appendChild(div);
      });
  }

  updateUI();
</script>

</body>
</html>
